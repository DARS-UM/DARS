---
title: "Data Preparation"
author: "DARS"
date: "`r Sys.Date()`"
output: pdf_document
---
# Libraries:
```{r setup, include=FALSE}
library(tidyverse)
library(tidytext) 

library(gsheet) # import spreadsheets from google drive
library(tm)
library(hunspell) # Stemmer
```

# Import Data

## Textual Data

## Course Catalogues
In order to conduct a preliminary topic modeling of course content, we first analyze their description in the course catalogues. The corpus `corpus` contains the pdfs of the `5` most recent course catalogues.
```{r corpus, cache = TRUE}
corpus <- Corpus(x             = DirSource("Catalogues"),
                 readerControl = list(reader = readPDF(control = list(text = "-layout"))))
```

## Course Manuals
To expand our topic modeling of course content, we would like to analyse the material in the course manuals. The `corpus_manuals` contains the pdfs of the course manuals for the year 2017-2018 (most recently, available).
```{r}
corpus_manuals <- Corpus(x             = DirSource("Manuals 2017-18"),
                 readerControl = list(reader = readPDF(control = list(text = "-layout"))))
```
## Student Data

### Transcripts

# Variable Engineering

##Course Manual 
We create a dataframe from the Corpus:
```{r}

manuals_td <- tidy(corpus_manuals)

```

From `manuals_td` we are only interested in the text, and the Code of the course. However, we don't have the code but we have a document id that includes it. Therefore we select only the `text` and `id` columns of the `manuals_td`. Then, we extract the code from the `id` and save it in under `Code`, We aso extract the concentration from the `id` and save it under `Concentration`. Finally, we unnest the dataframe to have only one word per row, and call this ``manuals_tokens.

```{r}
manuals_tokens <- manuals_td %>%
  select(id,text) %>%
  mutate(Concentration= substring(id, 1, 3), Code= substring(id,1,7))%>%
  unnest_tokens(word, text)
```



# Save Data

